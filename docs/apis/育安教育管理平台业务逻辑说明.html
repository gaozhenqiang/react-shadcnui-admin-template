<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>育安教育管理平台 - 业务模块逻辑说明</title>
    <style>
        body {
            font-family: "Microsoft YaHei", "SimSun", Arial, sans-serif;
            line-height: 1.8;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px;
            color: #333;
        }
        h1 {
            text-align: center;
            color: #1a1a1a;
            border-bottom: 3px solid #0066cc;
            padding-bottom: 15px;
            font-size: 28px;
        }
        h2 {
            color: #0066cc;
            border-left: 4px solid #0066cc;
            padding-left: 15px;
            margin-top: 40px;
            font-size: 22px;
        }
        h3 {
            color: #333;
            font-size: 18px;
            margin-top: 25px;
        }
        h4 {
            color: #555;
            font-size: 16px;
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f5f5f5;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #fafafa;
        }
        .highlight {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        .important {
            background-color: #f8d7da;
            padding: 15px;
            border-left: 4px solid #dc3545;
            margin: 15px 0;
        }
        .success {
            background-color: #d4edda;
            padding: 15px;
            border-left: 4px solid #28a745;
            margin: 15px 0;
        }
        .info {
            background-color: #d1ecf1;
            padding: 15px;
            border-left: 4px solid #17a2b8;
            margin: 15px 0;
        }
        .flow-box {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 20px;
            margin: 15px 0;
            font-family: "Courier New", monospace;
            white-space: pre-wrap;
            font-size: 14px;
        }
        .toc {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 20px;
        }
        .toc li {
            margin: 8px 0;
        }
        .toc a {
            color: #0066cc;
            text-decoration: none;
        }
        .version-info {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-bottom: 30px;
        }
        .page-break {
            page-break-after: always;
        }
        ul, ol {
            margin: 10px 0;
            padding-left: 25px;
        }
        li {
            margin: 5px 0;
        }
    </style>
</head>
<body>

<h1>育安教育管理平台<br>业务模块逻辑说明文档</h1>

<div class="version-info">
    <p><strong>文档版本：</strong>v2.4.0</p>
    <p><strong>更新日期：</strong>2025年12月7日</p>
    <p><strong>适用系统：</strong>育安教育管理平台后端服务</p>
</div>

<div class="toc">
    <h3>目 录</h3>
    <ul>
        <li><a href="#chapter1">一、用户注册与认证</a></li>
        <li><a href="#chapter2">二、报考管理</a></li>
        <li><a href="#chapter3">三、课程管理</a></li>
        <li><a href="#chapter4">四、考试管理</a></li>
        <li><a href="#chapter5">五、成绩管理</a></li>
        <li><a href="#chapter6">六、证书管理</a></li>
        <li><a href="#chapter7">七、物流管理</a></li>
        <li><a href="#chapter8">八、订单管理</a></li>
        <li><a href="#chapter9">九、完整业务流程</a></li>
    </ul>
</div>

<div class="page-break"></div>

<!-- ==================== 第一章：用户注册与认证 ==================== -->
<h2 id="chapter1">一、用户注册与认证</h2>

<h3>1.1 角色体系概述</h3>
<p>系统支持三种用户角色，每种角色拥有不同的权限和功能：</p>

<table>
    <tr>
        <th>角色</th>
        <th>角色代码</th>
        <th>说明</th>
        <th>注册方式</th>
    </tr>
    <tr>
        <td>管理员</td>
        <td>ADMIN (0)</td>
        <td>系统管理员，拥有最高权限，可管理所有业务模块</td>
        <td>由现有管理员在后台创建</td>
    </tr>
    <tr>
        <td>教师</td>
        <td>TEACHER (1)</td>
        <td>认证教师，可发布微课堂、评阅学员主观题</td>
        <td>手机验证码注册 + 认证审核</td>
    </tr>
    <tr>
        <td>学生</td>
        <td>STUDENT (2)</td>
        <td>普通学员，可学习课程、参加考试、获取证书</td>
        <td>手机验证码注册</td>
    </tr>
</table>

<h3>1.2 管理端 - 用户管理功能</h3>

<h4>1.2.1 功能概述</h4>
<p>管理员可以创建、编辑、删除和管理所有类型的用户账号，包括管理员、教师和学生。</p>

<h4>1.2.2 主要功能</h4>
<ol>
    <li><strong>创建管理员账号</strong>：输入手机号、密码、姓名，系统验证手机号唯一性后创建账号</li>
    <li><strong>创建学生账号</strong>：输入手机号、密码、姓名，创建学生角色账号</li>
    <li><strong>创建教师账号</strong>：输入手机号、密码、姓名，创建教师账号（需后续完成认证）</li>
    <li><strong>用户列表查询</strong>：支持按角色筛选、分页查询、搜索姓名或手机号</li>
    <li><strong>用户管理操作</strong>：更新用户信息、删除用户（软删除）、重置密码</li>
</ol>

<div class="highlight">
    <strong>关键规则：</strong>
    <ul>
        <li>手机号全局唯一，不可重复注册</li>
        <li>删除操作为软删除，标记状态为"inactive"</li>
        <li>重置密码后用户需要重新登录</li>
    </ul>
</div>

<h3>1.3 教师端 - 注册与认证流程</h3>

<h4>1.3.1 功能概述</h4>
<p>教师通过手机验证码注册账号，注册后需要提交个人认证信息，经管理员审核通过后才能获得完整的教师权限。</p>

<h4>1.3.2 注册认证流程</h4>

<div class="flow-box">
<strong>第一步：发送验证码</strong>
├── 教师输入手机号
├── 系统发送6位验证码
├── 验证码有效期：5分钟
├── 防刷机制：60秒内不可重复发送
└── 限制：同一IP每天最多10次

<strong>第二步：注册账号</strong>
├── 输入：手机号、密码、姓名、验证码
├── 系统验证验证码正确性和手机号唯一性
└── 创建教师账号（待认证状态）

<strong>第三步：填写认证信息</strong>
├── 必填项：职位、社会职务、联系电话、专业方向
├── 自动生成：性别、生日（从身份证号解析）
├── 必须提交：一寸证件照
├── 非必填项：籍贯、户口所在地、政治面貌、工作单位、邮箱、其他
└── 提交后状态变更为"待审核"

<strong>第四步：管理员审核</strong>
├── 审核通过：教师获得完整权限
└── 审核拒绝：告知拒绝原因，教师可修改后重新提交

<strong>第五步：登录使用</strong>
├── 已认证教师：可发布微课堂、评阅主观题
└── 未认证教师：功能受限
</div>

<h4>1.3.3 认证字段说明</h4>
<table>
    <tr>
        <th>字段</th>
        <th>是否必填</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>职位</td>
        <td>是</td>
        <td>当前工作职位</td>
    </tr>
    <tr>
        <td>社会职务</td>
        <td>是</td>
        <td>社会兼任职务</td>
    </tr>
    <tr>
        <td>联系电话</td>
        <td>是</td>
        <td>用于联系的电话号码</td>
    </tr>
    <tr>
        <td>专业方向</td>
        <td>是</td>
        <td>教学专业方向</td>
    </tr>
    <tr>
        <td>身份证号</td>
        <td>是</td>
        <td>用于身份核验</td>
    </tr>
    <tr>
        <td>一寸证件照</td>
        <td>是</td>
        <td>标准证件照片</td>
    </tr>
    <tr>
        <td>籍贯</td>
        <td>否</td>
        <td>户口本记载的籍贯</td>
    </tr>
    <tr>
        <td>户口所在地</td>
        <td>否</td>
        <td>当前户口所在省份</td>
    </tr>
    <tr>
        <td>政治面貌</td>
        <td>否</td>
        <td>如党员、群众等</td>
    </tr>
    <tr>
        <td>工作单位</td>
        <td>否</td>
        <td>当前工作单位名称</td>
    </tr>
    <tr>
        <td>邮箱</td>
        <td>否</td>
        <td>电子邮箱地址</td>
    </tr>
</table>

<h3>1.4 学生端 - 注册与登录流程</h3>

<h4>1.4.1 功能概述</h4>
<p>学生通过手机验证码注册账号，注册完成后可选择"报名考试"或"仅注册不报名"两种路径。</p>

<h4>1.4.2 注册流程</h4>

<div class="flow-box">
<strong>第一步：发送验证码</strong>
├── 输入手机号
├── 选择类型：注册 或 登录
└── 接收6位验证码

<strong>第二步：注册账号</strong>
├── 输入：手机号、密码、姓名、验证码
├── 系统验证并创建学生账号
└── 注册成功

<strong>第三步：选择后续操作（弹窗提示）</strong>
├── 选项A："报名考试"
│   └── 跳转到报考项目选择页面，开始报考流程
│
└── 选项B："仅注册不报名考试"
    └── 以普通学员身份浏览微课堂和案例学习

<strong>第四步：登录使用</strong>
├── 输入手机号和密码登录
├── 获取JWT Token
└── 可访问所有学生端功能
</div>

<div class="info">
    <strong>特点说明：</strong>
    <ul>
        <li>支持手机验证码登录（无需密码）</li>
        <li>未来将支持微信扫码登录</li>
        <li>Token有效期为7天</li>
    </ul>
</div>

<div class="page-break"></div>

<!-- ==================== 第二章：报考管理 ==================== -->
<h2 id="chapter2">二、报考管理</h2>

<h3>2.1 业务概述</h3>
<p>报考管理是系统的核心业务模块，实现了从证书分类配置到学员报考申请的完整流程。</p>

<h4>2.1.1 核心概念层级</h4>
<div class="flow-box">
证书分类（CertificateCategory）
    └── 证书等级（CertificateLevel）
        └── 证书配置（CertificateConfig）
            └── 关联课程列表
                └── 学员报考（StudentEnrollment）
</div>

<h4>2.1.2 示例说明</h4>
<table>
    <tr>
        <th>层级</th>
        <th>示例</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>证书分类</td>
        <td>心理咨询师</td>
        <td>证书的大类别</td>
    </tr>
    <tr>
        <td>证书等级</td>
        <td>初级、中级、高级</td>
        <td>同一分类下的不同级别</td>
    </tr>
    <tr>
        <td>证书配置</td>
        <td>初级心理咨询师认证</td>
        <td>具体的证书配置，关联必修课程</td>
    </tr>
    <tr>
        <td>关联课程</td>
        <td>心理学基础、咨询技术、案例分析</td>
        <td>获取该证书需要学习的课程</td>
    </tr>
</table>

<h3>2.2 管理端 - 报考配置管理</h3>

<h4>2.2.1 证书分类管理</h4>
<p>管理员可以创建和管理证书的大类别。</p>
<ul>
    <li>创建证书分类：设置分类名称、编码、描述、状态</li>
    <li>更新分类信息：修改分类的各项属性</li>
    <li>删除证书分类：删除不再使用的分类</li>
    <li>查询分类列表：获取所有证书分类</li>
</ul>

<h4>2.2.2 证书等级管理</h4>
<p>在证书分类下创建不同的等级。</p>
<ul>
    <li>创建证书等级：设置等级名称、级别、报考要求、说明</li>
    <li>配置报考条件：设置不同等级需要填写的字段（如职位、职级、工作证明等）</li>
    <li>配置报考说明文本：详细说明报考该等级的条件和要求</li>
</ul>

<h4>2.2.3 证书配置管理（核心）</h4>
<p>证书配置是将证书等级与具体课程关联的核心配置。</p>

<table>
    <tr>
        <th>配置项</th>
        <th>说明</th>
        <th>示例</th>
    </tr>
    <tr>
        <td>证书分类</td>
        <td>所属的证书分类</td>
        <td>心理咨询师</td>
    </tr>
    <tr>
        <td>证书等级</td>
        <td>所属的证书等级</td>
        <td>初级</td>
    </tr>
    <tr>
        <td>配置名称</td>
        <td>证书配置的名称</td>
        <td>初级心理咨询师认证</td>
    </tr>
    <tr>
        <td>关联课程</td>
        <td>必须完成的课程列表</td>
        <td>3门课程</td>
    </tr>
    <tr>
        <td>有效期</td>
        <td>报考的有效期限</td>
        <td>2年</td>
    </tr>
    <tr>
        <td>考试次数</td>
        <td>每门课程的最大考试次数</td>
        <td>2次</td>
    </tr>
</table>

<h4>2.2.4 报名审核管理</h4>
<p>管理员审核学员提交的报名申请。</p>

<div class="flow-box">
审核流程：
1. 查看待审核的报名申请列表
2. 点击查看申请详情
3. 核实学员提交的材料：
   ├── 身份证信息
   ├── 学历证书
   ├── 工作证明（部分等级需要）
   └── 一寸证件照
4. 做出审核决定：
   ├── 通过：设置报考生效，开始2年有效期
   └── 拒绝：填写拒绝原因，学员可修改后重新提交
</div>

<h3>2.3 学生端 - 报考申请流程</h3>

<h4>2.3.1 完整报考流程</h4>

<div class="flow-box">
<strong>第一步：浏览报考项目</strong>
├── 查看所有可报考的证书项目
├── 按分类、等级筛选
└── 了解报考条件和费用

<strong>第二步：选择报考等级</strong>
├── 点击想要报考的等级
├── 弹窗展示报考条件
├── 学员下拉页面到底部
├── 点击"已知晓报考条件"确认
└── 进入报名信息填写页面

<strong>第三步：填写报名信息</strong>
必填项：
├── 姓名
├── 身份证号
├── 最高学历
├── 工作年限
├── 联系电话
├── 详细地址（接收纸质证书用）
├── 岗位（部分等级需要）
└── 职级（部分等级需要）

自动生成项（从身份证解析）：
├── 性别
└── 生日

必须提交材料：
├── 工作证明（部分等级需要）
├── 最高学历证书
└── 一寸证件照

非必填项：
├── 籍贯
├── 户口所在地
├── 政治面貌
├── 工作单位
├── 邮箱
└── 其他

<strong>第四步：提交申请，等待审核</strong>
├── 提交后状态为"待审核"
├── 管理员审核通过后开始有效期
└── 审核拒绝可查看原因并重新提交

<strong>第五步：审核通过后购买课程</strong>
├── 查看该等级包含的课程列表
├── 查看每门课程的费用
├── 可选择一门、多门或全部课程购买
├── 支付有效期为3分钟
└── 支付成功后开通学习权限
</div>

<h4>2.3.2 重要业务规则</h4>

<div class="important">
    <strong>报考有效期规则：</strong>
    <ul>
        <li>报考有效期为<strong>2年</strong>，从审核通过时开始计算</li>
        <li>2年内必须完成所有课程学习和考试</li>
        <li>超过2年未完成，报考自动失效</li>
        <li>失效后需要重新报考、重新购买所有课程</li>
    </ul>
</div>

<div class="highlight">
    <strong>课程共享/去重规则：</strong>
    <ul>
        <li>学员可以同时报考多个证书</li>
        <li>如果两个证书包含相同的课程，该课程只需学习和考试一次</li>
        <li>例如：报考证书A（含课程X、Y）和证书B（含课程X、I、F），课程X只需完成一次</li>
    </ul>
</div>

<div class="info">
    <strong>补考机制：</strong>
    <ul>
        <li>每门课程有<strong>2次免费考试机会</strong>（首考 + 1次补考）</li>
        <li>2次都未通过，需要<strong>重新购买该课程</strong></li>
        <li>重新购买后再次获得2次考试机会</li>
    </ul>
</div>

<div class="page-break"></div>

<!-- ==================== 第三章：课程管理 ==================== -->
<h2 id="chapter3">三、课程管理</h2>

<h3>3.1 业务概述</h3>
<p>课程是学员学习的核心内容，系统支持免费课程和收费课程两种类型，每个课程包含多个章节。</p>

<h3>3.2 课程类型说明</h3>

<table>
    <tr>
        <th>类型</th>
        <th>访问权限</th>
        <th>是否需要购买</th>
        <th>适用场景</th>
    </tr>
    <tr>
        <td>免费课程</td>
        <td>所有学员可直接访问</td>
        <td>否</td>
        <td>公开宣传、入门介绍</td>
    </tr>
    <tr>
        <td>收费课程</td>
        <td>购买后才能访问完整内容</td>
        <td>是</td>
        <td>正式课程、考试课程</td>
    </tr>
</table>

<h3>3.3 管理端 - 课程管理功能</h3>

<h4>3.3.1 课程基本管理</h4>
<ul>
    <li><strong>创建课程</strong>：设置课程名称、描述、封面、价格、讲师、所属项目等</li>
    <li><strong>更新课程</strong>：修改课程的各项信息</li>
    <li><strong>删除课程</strong>：删除不再使用的课程</li>
    <li><strong>课程列表</strong>：支持按项目筛选、关键词搜索、分页查询</li>
</ul>

<h4>3.3.2 章节管理</h4>
<ul>
    <li><strong>创建章节</strong>：设置章节标题、排序、内容类型、媒体文件等</li>
    <li><strong>更新章节</strong>：修改章节信息和内容</li>
    <li><strong>删除章节</strong>：删除不需要的章节</li>
    <li><strong>章节列表</strong>：查看课程下的所有章节</li>
</ul>

<h4>3.3.3 章节内容类型</h4>
<table>
    <tr>
        <th>内容类型</th>
        <th>说明</th>
        <th>支持格式</th>
    </tr>
    <tr>
        <td>video</td>
        <td>视频内容</td>
        <td>MP4、MOV等</td>
    </tr>
    <tr>
        <td>pdf</td>
        <td>PDF文档</td>
        <td>PDF</td>
    </tr>
    <tr>
        <td>ppt</td>
        <td>演示文稿</td>
        <td>PPT、PPTX</td>
    </tr>
</table>

<h4>3.3.4 文件上传</h4>
<p>系统集成阿里云OSS进行文件存储：</p>
<ol>
    <li>管理员请求获取上传凭证</li>
    <li>前端直接上传文件到OSS</li>
    <li>上传完成后获取文件访问地址</li>
    <li>将地址保存到章节配置中</li>
</ol>

<h3>3.4 学生端 - 课程学习功能</h3>

<h4>3.4.1 课程访问控制逻辑</h4>

<div class="flow-box">
<strong>免费课程（isFree = true）：</strong>
├── 所有学员都可以直接访问
├── 可以查看所有章节内容
├── 可以观看视频、下载PDF
└── 不需要购买

<strong>收费课程（isFree = false）：</strong>
├── 未购买时：
│   ├── 可以看到课程基本信息
│   ├── 可以看到章节标题和描述
│   ├── 无法看到视频/PDF链接
│   └── 显示"请购买后查看"提示
│
└── 购买后：
    ├── 可以访问所有章节内容
    ├── 可以观看视频、下载PDF
    ├── 可以记录学习进度
    └── 可以添加书签
</div>

<h4>3.4.2 学习进度管理</h4>
<p>系统自动记录学员的学习进度：</p>
<ul>
    <li><strong>开始学习</strong>：创建学习进度记录，标记为首次学习</li>
    <li><strong>更新进度</strong>：记录当前观看位置和完成百分比</li>
    <li><strong>章节完成</strong>：标记章节为已完成</li>
    <li><strong>进度查询</strong>：查看已完成章节数、学习时长、整体进度</li>
</ul>

<h4>3.4.3 学习规则</h4>

<div class="highlight">
    <strong>首次学习规则：</strong>
    <ul>
        <li>首次学习课程时，<strong>不允许跳过章节</strong></li>
        <li>必须按照章节顺序学习</li>
        <li>完成一个章节才能进入下一个章节</li>
    </ul>
</div>

<div class="info">
    <strong>补学规则（首次考试未通过后重新学习）：</strong>
    <ul>
        <li>允许跳过已学过的章节</li>
        <li>可以快进视频</li>
        <li>可以直接进入需要复习的部分</li>
    </ul>
</div>

<h4>3.4.4 书签功能</h4>
<p>学员可以在学习过程中添加书签：</p>
<ul>
    <li>记录重要知识点的位置</li>
    <li>添加备注说明</li>
    <li>方便后续快速定位复习</li>
</ul>

<h4>3.4.5 学习完成与考试</h4>
<div class="flow-box">
课程学习完成后：
├── 系统检查是否达到必修学时
├── 弹窗显示"开始考试"按钮
├── 学员点击后进入考试界面
└── 考试完成后显示提示：
    "本课程成绩有效期两年。请在两年内通过等级其他课程考试，
     否则需重新缴费参加学习和考试。"
</div>

<div class="page-break"></div>

<!-- ==================== 第四章：考试管理 ==================== -->
<h2 id="chapter4">四、考试管理</h2>

<h3>4.1 业务概述</h3>
<p>考试系统支持多种题型和考试类型，实现了智能组卷、自动批改、教师评阅的完整考试流程。</p>

<h3>4.2 题型支持</h3>

<table>
    <tr>
        <th>题型</th>
        <th>代码</th>
        <th>类别</th>
        <th>批改方式</th>
    </tr>
    <tr>
        <td>单选题</td>
        <td>single</td>
        <td>客观题</td>
        <td>系统自动批改</td>
    </tr>
    <tr>
        <td>多选题</td>
        <td>multiple</td>
        <td>客观题</td>
        <td>系统自动批改</td>
    </tr>
    <tr>
        <td>判断题</td>
        <td>judgment</td>
        <td>客观题</td>
        <td>系统自动批改</td>
    </tr>
    <tr>
        <td>解答题</td>
        <td>subjective</td>
        <td>主观题</td>
        <td>教师人工评分</td>
    </tr>
    <tr>
        <td>论文题</td>
        <td>thesis</td>
        <td>主观题</td>
        <td>教师人工评分</td>
    </tr>
</table>

<h3>4.3 考试类型</h3>

<table>
    <tr>
        <th>考试类型</th>
        <th>代码</th>
        <th>包含题型</th>
        <th>适用场景</th>
    </tr>
    <tr>
        <td>纯选择题</td>
        <td>multiple_choice</td>
        <td>单选、多选、判断</td>
        <td>初级证书考试</td>
    </tr>
    <tr>
        <td>选择题+报告</td>
        <td>mc_report</td>
        <td>单选、多选、判断、解答题</td>
        <td>中级证书考试</td>
    </tr>
    <tr>
        <td>论文</td>
        <td>thesis</td>
        <td>论文题</td>
        <td>高级证书考试</td>
    </tr>
</table>

<h3>4.4 管理端 - 考试配置</h3>

<h4>4.4.1 题库管理</h4>
<ul>
    <li><strong>创建题库</strong>：为特定课程创建题库</li>
    <li><strong>添加题目</strong>：录入各类型题目，设置答案、解析、分值、难度</li>
    <li><strong>更新题目</strong>：修改题目内容和配置</li>
    <li><strong>删除题目</strong>：删除不需要的题目</li>
    <li><strong>题库查询</strong>：支持按题型筛选、关键词搜索</li>
</ul>

<h4>4.4.2 考试配置</h4>
<p>为每门课程配置考试规则：</p>
<table>
    <tr>
        <th>配置项</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>考试名称</td>
        <td>考试的名称，如"心理学基础理论考试"</td>
    </tr>
    <tr>
        <td>关联课程</td>
        <td>该考试对应的课程</td>
    </tr>
    <tr>
        <td>选择题库</td>
        <td>从哪个题库抽取题目</td>
    </tr>
    <tr>
        <td>考试类型</td>
        <td>纯选择题/选择题+报告/论文</td>
    </tr>
    <tr>
        <td>题目配置</td>
        <td>各题型的数量、分值</td>
    </tr>
    <tr>
        <td>总分</td>
        <td>考试满分，通常为100分</td>
    </tr>
    <tr>
        <td>及格分</td>
        <td>通过考试的最低分数，通常为60分</td>
    </tr>
    <tr>
        <td>主观题提交期限</td>
        <td>客观题完成后，主观题的提交天数</td>
    </tr>
</table>

<h4>4.4.3 考试组卷功能</h4>
<p>管理员可以使用智能组卷功能：</p>
<ol>
    <li>选择题库</li>
    <li>获取题库中各题型的数量统计</li>
    <li>按题型筛选和选择题目</li>
    <li>实时计算已选题目的总分</li>
    <li>系统验证是否符合考试配置要求</li>
    <li>达到目标分值后保存配置</li>
</ol>

<h4>4.4.4 考试评阅分配</h4>
<p>对于包含主观题的考试，管理员需要分配评阅教师：</p>
<ul>
    <li><strong>手动分配</strong>：管理员直接指定评阅教师</li>
    <li><strong>自动分配</strong>：系统按策略自动分配
        <ul>
            <li>按工作量分配：优先分配给当前任务最少的教师</li>
            <li>按专业方向分配：匹配学员报考方向和教师专业</li>
        </ul>
    </li>
    <li><strong>批量分配</strong>：一次性为多个考试分配评阅教师</li>
</ul>

<h3>4.5 教师端 - 主观题评分</h3>

<h4>4.5.1 评分任务</h4>
<p>教师登录后可以查看分配给自己的评分任务：</p>
<ul>
    <li>查看待评分任务列表</li>
    <li>查看学员的答案内容</li>
    <li>参考标准答案和评分标准</li>
    <li>给出分数和评语</li>
    <li>提交评分结果</li>
</ul>

<h4>4.5.2 评分完成后的处理</h4>
<div class="flow-box">
评分完成后系统自动处理：
├── 检查该试卷所有题目是否都已评分
├── 如果都已评分：
│   ├── 计算总分（客观题分 + 主观题分）
│   ├── 对比及格分判定是否通过
│   └── 更新学员考试状态和成绩
└── 如果还有未评分题目：等待其他教师完成评分
</div>

<h4>4.5.3 论文评审</h4>
<p>对于论文类型的考试，教师进行论文评审：</p>
<ul>
    <li>查看学员提交的论文内容</li>
    <li>下载论文附件</li>
    <li>给出评分（0-100分）</li>
    <li>填写评审意见和修改建议</li>
    <li>提交评审结果</li>
</ul>

<h3>4.6 学生端 - 在线考试</h3>

<h4>4.6.1 考试前置检查</h4>
<p>学员开始考试前，系统会进行以下检查：</p>
<ul>
    <li>报考是否在有效期内</li>
    <li>课程是否已购买</li>
    <li>是否还有剩余考试次数（≥1次）</li>
    <li>该课程考试是否已通过（已通过则无需再考）</li>
    <li>课程学习是否完成（达到必修学时）</li>
</ul>

<h4>4.6.2 考试流程</h4>

<div class="flow-box">
<strong>第一阶段：客观题</strong>
├── 系统生成试卷
├── 开始客观题答题
├── 每道题有独立计时（如2分钟/题）
├── 时间到自动提交当前题答案
├── 不能回退到上一题
└── 所有客观题完成后进入下一阶段

<strong>第二阶段：主观题（如有）</strong>
├── 客观题全部完成后开始
├── 显示剩余提交时间（如7天）
├── 可以保存草稿
├── 最终提交前可修改
└── 超时未提交则该题得0分

<strong>第三阶段：提交试卷</strong>
├── 提交所有答案
├── 客观题即时自动批改
├── 主观题等待教师评分
└── 返回客观题成绩

<strong>第四阶段：等待结果</strong>
├── 查看考试状态
├── 客观题成绩（即时可见）
├── 主观题成绩（教师评分后可见）
└── 总成绩和是否通过
</div>

<h4>4.6.3 考试结果处理</h4>

<div class="success">
    <strong>考试通过：</strong>
    <ul>
        <li>更新课程考试状态为"已通过"</li>
        <li>更新报考进度（已通过课程数+1）</li>
        <li>检查是否所有课程都已通过</li>
        <li>如果全部通过，则满足证书申请资格</li>
    </ul>
</div>

<div class="important">
    <strong>考试未通过：</strong>
    <ul>
        <li>检查剩余考试次数</li>
        <li>还有次数：提示"可补考"，继续学习后再次参加考试</li>
        <li>次数用完：提示"需重新购买课程"</li>
    </ul>
</div>

<div class="page-break"></div>

<!-- ==================== 第五章：成绩管理 ==================== -->
<h2 id="chapter5">五、成绩管理</h2>

<h3>5.1 管理端 - 成绩查询</h3>

<h4>5.1.1 功能说明</h4>
<p>管理员可以查看所有学员的考试成绩记录。</p>

<h4>5.1.2 查询功能</h4>
<ul>
    <li>查询所有考试记录</li>
    <li>按学员姓名/手机号筛选</li>
    <li>按课程筛选</li>
    <li>按时间范围筛选</li>
    <li>查看详细成绩分布</li>
</ul>

<h4>5.1.3 成绩信息</h4>
<table>
    <tr>
        <th>字段</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>学员姓名</td>
        <td>参加考试的学员</td>
    </tr>
    <tr>
        <td>课程名称</td>
        <td>考试对应的课程</td>
    </tr>
    <tr>
        <td>考试次数</td>
        <td>第几次考试（首考/补考）</td>
    </tr>
    <tr>
        <td>客观题得分</td>
        <td>选择题、判断题的得分</td>
    </tr>
    <tr>
        <td>主观题得分</td>
        <td>解答题、论文的得分</td>
    </tr>
    <tr>
        <td>总分</td>
        <td>客观题+主观题的总分</td>
    </tr>
    <tr>
        <td>是否通过</td>
        <td>总分≥及格分则通过</td>
    </tr>
    <tr>
        <td>评阅教师</td>
        <td>评阅主观题的教师</td>
    </tr>
    <tr>
        <td>考试时间</td>
        <td>开始时间、提交时间、评分时间</td>
    </tr>
</table>

<h3>5.2 学生端 - 成绩查询</h3>

<h4>5.2.1 我的考试记录</h4>
<p>学员可以查看自己的所有考试记录：</p>
<ul>
    <li>每次考试的成绩</li>
    <li>是否通过</li>
    <li>剩余考试次数</li>
    <li>考试详情（各题得分情况）</li>
</ul>

<h4>5.2.2 报考进度查询</h4>
<p>学员可以查看报考的整体进度：</p>
<ul>
    <li>该等级包含的所有课程</li>
    <li>每门课程的考试状态（未考试/已通过/未通过）</li>
    <li>已通过课程数 / 总课程数</li>
    <li>距离取证还差几门课程</li>
    <li>报考剩余有效期</li>
</ul>

<div class="page-break"></div>

<!-- ==================== 第六章：证书管理 ==================== -->
<h2 id="chapter6">六、证书管理</h2>

<h3>6.1 业务概述</h3>
<p>证书管理涵盖证书生成、工本费管理、纸质证书邮寄、扫描版上传等功能。</p>

<h3>6.2 证书生成条件</h3>

<div class="success">
    <strong>自动生成证书的条件：</strong>
    <ul>
        <li>学员该等级的<strong>所有课程考试都通过</strong></li>
        <li>报考在<strong>2年有效期内</strong></li>
        <li>满足以上条件后，系统自动生成电子证书</li>
    </ul>
</div>

<h3>6.3 证书信息</h3>

<table>
    <tr>
        <th>字段</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>证书编号</td>
        <td>唯一编号，如CERT-2025-001234</td>
    </tr>
    <tr>
        <td>证书类型</td>
        <td>考试证书/培训证书/荣誉证书</td>
    </tr>
    <tr>
        <td>证书名称</td>
        <td>如"初级心理咨询师证书"</td>
    </tr>
    <tr>
        <td>证书等级</td>
        <td>初级/中级/高级</td>
    </tr>
    <tr>
        <td>发证日期</td>
        <td>证书颁发日期</td>
    </tr>
    <tr>
        <td>有效期</td>
        <td>证书的有效期限</td>
    </tr>
    <tr>
        <td>持证人信息</td>
        <td>姓名、身份证号、照片</td>
    </tr>
    <tr>
        <td>是否需要纸质证书</td>
        <td>学员可选择是否申请纸质证书</td>
    </tr>
</table>

<h3>6.4 管理端 - 证书管理功能</h3>

<h4>6.4.1 证书实例管理</h4>
<ul>
    <li>查看证书实例列表</li>
    <li>查看证书详情</li>
    <li>上传纸质证书扫描版</li>
    <li>删除扫描版</li>
</ul>

<h4>6.4.2 扫描版上传功能</h4>
<p>管理员可以上传纸质证书的扫描版：</p>
<ul>
    <li>记录上传人和上传时间</li>
    <li>学员可在线查看扫描版</li>
    <li>便于证书验证和存档</li>
</ul>

<h3>6.5 学生端 - 证书查询</h3>

<h4>6.5.1 我的证书</h4>
<ul>
    <li>查看已获得的所有证书</li>
    <li>查看电子证书详情</li>
    <li>查看扫描版（如已上传）</li>
    <li>申请纸质证书邮寄</li>
</ul>

<h4>6.5.2 证书验证</h4>
<p>系统提供证书查询链接，学员可跳转至"中人会"网站进行证书真伪验证。</p>

<h3>6.6 证书获取完整流程</h3>

<div class="flow-box">
<strong>步骤一：满足条件</strong>
├── 所有课程考试通过 ✓
└── 报考在有效期内 ✓

<strong>步骤二：系统生成电子证书</strong>
├── 自动生成证书编号
├── 记录持证人信息
└── 设置证书有效期

<strong>步骤三：申请纸质证书（可选）</strong>
├── 学员申请纸质证书
├── 支付工本费
└── 填写邮寄地址

<strong>步骤四：证书制作与邮寄</strong>
├── 管理员制作纸质证书
├── 上传扫描版存档
├── 创建物流记录
└── 发货

<strong>步骤五：学员收取</strong>
├── 查看物流轨迹
├── 确认收货
└── 取证完成 ✓
</div>

<div class="page-break"></div>

<!-- ==================== 第七章：物流管理 ==================== -->
<h2 id="chapter7">七、物流管理</h2>

<h3>7.1 业务概述</h3>
<p>物流管理模块用于管理纸质证书的邮寄过程，包括物流记录创建、轨迹更新、签收确认等功能。</p>

<h3>7.2 管理端 - 物流管理功能</h3>

<h4>7.2.1 主要功能</h4>
<ul>
    <li><strong>创建物流记录</strong>：关联证书、填写收件人信息、快递公司、快递单号</li>
    <li><strong>更新物流信息</strong>：修改物流相关信息</li>
    <li><strong>添加物流轨迹</strong>：记录快件的运输状态和位置</li>
    <li><strong>物流查询</strong>：按快递单号或证书ID查询物流信息</li>
</ul>

<h4>7.2.2 物流状态</h4>
<table>
    <tr>
        <th>状态</th>
        <th>代码</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>待发货</td>
        <td>pending</td>
        <td>物流记录已创建，等待发货</td>
    </tr>
    <tr>
        <td>已发货</td>
        <td>shipped</td>
        <td>快件已揽收发出</td>
    </tr>
    <tr>
        <td>运输中</td>
        <td>in_transit</td>
        <td>快件在途中</td>
    </tr>
    <tr>
        <td>已签收</td>
        <td>delivered</td>
        <td>收件人已签收</td>
    </tr>
</table>

<h4>7.2.3 物流轨迹</h4>
<p>每条物流轨迹包含：</p>
<ul>
    <li>时间：轨迹发生的时间</li>
    <li>状态：如已揽收、运输中、派送中、已签收</li>
    <li>描述：详细说明，如"快件已从北京发出"</li>
    <li>位置：当前位置，如"北京分拨中心"</li>
</ul>

<h3>7.3 物流管理流程</h3>

<div class="flow-box">
<strong>步骤一：学员支付工本费</strong>
└── 填写邮寄地址（收件人、电话、地址）

<strong>步骤二：管理员创建物流记录</strong>
├── 关联证书ID
├── 填写收件人信息
├── 填写快递公司（如顺丰、圆通等）
├── 填写快递单号
└── 状态设为"待发货"

<strong>步骤三：发货</strong>
├── 更新状态为"已发货"
├── 添加揽收轨迹
└── 记录发货时间

<strong>步骤四：运输中</strong>
├── 定期更新物流轨迹
├── 状态更新为"运输中"
└── 学员可实时查看物流状态

<strong>步骤五：签收</strong>
├── 更新状态为"已签收"
├── 记录签收时间
└── 通知学员
</div>

<div class="page-break"></div>

<!-- ==================== 第八章：订单管理 ==================== -->
<h2 id="chapter8">八、订单管理</h2>

<h3>8.1 订单类型</h3>

<table>
    <tr>
        <th>类型</th>
        <th>代码</th>
        <th>说明</th>
        <th>创建方</th>
    </tr>
    <tr>
        <td>课程购买</td>
        <td>course</td>
        <td>购买收费课程</td>
        <td>学员端</td>
    </tr>
    <tr>
        <td>微课堂购买</td>
        <td>micro_course</td>
        <td>购买教师微课堂</td>
        <td>学员端</td>
    </tr>
    <tr>
        <td>证书工本费</td>
        <td>certificate</td>
        <td>纸质证书工本费</td>
        <td>学员端</td>
    </tr>
    <tr>
        <td>报考课程</td>
        <td>enrollment_courses</td>
        <td>报考后购买课程</td>
        <td>学员端</td>
    </tr>
</table>

<h3>8.2 订单状态流转</h3>

<div class="flow-box">
订单状态流转图：

pending (待支付)
    │
    ├──→ paid (已支付) ───→ completed (已完成)
    │
    ├──→ cancelled (已取消)
    │
    ├──→ expired (已过期，超时未支付)
    │
    └──→ refund_pending (退款申请中) ───→ refunded (已退款)
</div>

<h3>8.3 学生端 - 订单管理</h3>

<h4>8.3.1 创建订单</h4>
<p>学员可以创建以下类型的订单：</p>
<ul>
    <li>购买课程</li>
    <li>购买微课堂</li>
    <li>支付证书工本费</li>
    <li>报考后购买课程</li>
</ul>

<h4>8.3.2 支付有效期</h4>
<div class="highlight">
    <strong>支付时效规则：</strong>
    <ul>
        <li>普通订单（课程、微课堂等）：<strong>15分钟</strong>内完成支付</li>
        <li>报考课程订单：<strong>3分钟</strong>内完成支付</li>
        <li>超时未支付，订单自动取消</li>
    </ul>
</div>

<h4>8.3.3 申请退款</h4>
<p>学员可以对已支付的订单申请退款：</p>
<ol>
    <li>选择要退款的订单</li>
    <li>填写退款原因</li>
    <li>提交退款申请</li>
    <li>等待管理员审核</li>
</ol>

<h3>8.4 管理端 - 订单管理</h3>

<h4>8.4.1 订单查询</h4>
<ul>
    <li>查看所有订单列表</li>
    <li>按类型、状态筛选</li>
    <li>查看订单详情</li>
    <li>取消订单</li>
</ul>

<h4>8.4.2 退款审核</h4>
<ol>
    <li>查看退款申请列表</li>
    <li>查看退款申请详情</li>
    <li>做出审核决定（通过/拒绝）</li>
    <li>通过后系统自动执行退款</li>
</ol>

<h4>8.4.3 退款成功后的处理</h4>
<ul>
    <li>订单状态更新为"已退款"</li>
    <li>调用支付接口原路退回款项</li>
    <li>撤销相关业务权限（如课程访问权限）</li>
    <li>通知学员退款结果</li>
</ul>

<h3>8.5 支付流程</h3>

<div class="flow-box">
<strong>步骤一：创建订单</strong>
├── 学员选择要购买的商品
├── 选择支付方式（支付宝/微信）
├── 系统创建订单记录
└── 返回支付链接或二维码

<strong>步骤二：发起支付</strong>
├── 支付宝：跳转支付页面完成支付
├── 微信：扫描二维码完成支付
└── 用户在规定时间内完成支付

<strong>步骤三：异步回调</strong>
├── 支付平台通知系统支付结果
├── 系统验证签名确保安全
└── 更新订单状态为"已支付"

<strong>步骤四：业务处理</strong>
├── 课程订单 → 开通课程访问权限
├── 微课堂订单 → 开通微课堂访问权限
├── 证书订单 → 创建物流记录
└── 报考课程订单 → 开通课程学习和考试权限
</div>

<div class="page-break"></div>

<!-- ==================== 第九章：完整业务流程 ==================== -->
<h2 id="chapter9">九、完整业务流程</h2>

<h3>9.1 学员完整学习取证流程</h3>

<div class="flow-box">
<strong>第一阶段：注册与报考</strong>
────────────────────────────────────────────
注册账号 → 选择"报名考试" → 浏览报考项目 → 选择证书等级
→ 查看报考条件（弹窗下拉确认）→ 填写报名信息 → 上传证明材料
→ 提交申请 → 等待审核 → 审核通过 → 报考生效（2年有效期）

<strong>第二阶段：购买课程</strong>
────────────────────────────────────────────
查看该等级包含的课程列表 → 选择课程（可多选）
→ 确认金额 → 支付（3分钟有效）→ 支付成功 → 开通学习权限

<strong>第三阶段：课程学习</strong>
────────────────────────────────────────────
进入课程 → 按顺序学习章节（首次不可跳章）
→ 观看视频/阅读PDF → 记录学习进度 → 添加书签（可选）
→ 完成必修学时 → 课程学习完成

<strong>第四阶段：参加考试</strong>
────────────────────────────────────────────
弹窗"开始考试" → 进入考试 → 客观题答题（每题计时）
→ 主观题答题（7天提交期限）→ 提交试卷
→ 客观题即时出分 → 等待主观题评分 → 最终成绩

<strong>第五阶段：考试结果</strong>
────────────────────────────────────────────
├── 通过 → 完成该课程 → 进度+1 → 继续下一门课程
│
└── 未通过 → 检查剩余次数
    ├── 有次数 → 继续学习 → 补考
    └── 无次数 → 重新购买课程 → 再次学习和考试

<strong>第六阶段：获取证书</strong>
────────────────────────────────────────────
所有课程通过 → 系统生成电子证书 → 申请纸质证书（可选）
→ 支付工本费 → 填写邮寄地址 → 等待邮寄
→ 查看物流 → 签收 → 取证完成 ✓

<strong>特殊情况：报考过期</strong>
────────────────────────────────────────────
2年内未完成所有考试 → 报考失效 → 所有成绩作废
→ 需重新报考 → 重新购买所有课程 → 从头开始
</div>

<h3>9.2 教师认证与评分流程</h3>

<div class="flow-box">
<strong>认证流程：</strong>
────────────────────────────────────────────
注册账号 → 填写认证信息 → 上传证件照 → 提交认证
→ 管理员审核 → 审核通过 → 获得教师权限

<strong>评分流程：</strong>
────────────────────────────────────────────
登录系统 → 查看待评分任务 → 接收任务分配
→ 查看学员答案 → 参考评分标准 → 给分并写评语
→ 提交评分 → 系统计算总分 → 更新学员成绩
</div>

<h3>9.3 管理员日常运营流程</h3>

<div class="flow-box">
<strong>报考审核：</strong>
────────────────────────────────────────────
查看待审核列表 → 审核学员资料 → 通过/拒绝 → 通知学员

<strong>考试管理：</strong>
────────────────────────────────────────────
配置考试 → 选择题库 → 组卷 → 分配评阅教师 → 监控考试进度

<strong>证书管理：</strong>
────────────────────────────────────────────
查看待发证书 → 制作纸质证书 → 上传扫描版 → 创建物流 → 发货

<strong>订单管理：</strong>
────────────────────────────────────────────
查看订单列表 → 处理退款申请 → 审核通过/拒绝 → 执行退款
</div>

<h3>9.4 数据流转总览</h3>

<div class="flow-box">
用户注册
    │
    ▼
┌─────────┐
│  学员   │
└────┬────┘
     │
     ▼
┌─────────┐      ┌─────────┐      ┌─────────┐      ┌─────────┐
│ 报考申请 │ ───▶ │ 管理审核 │ ───▶ │ 课程购买 │ ───▶ │ 课程学习 │
└─────────┘      └─────────┘      └────┬────┘      └────┬────┘
                                       │                │
                                       ▼                ▼
                                  ┌─────────┐      ┌─────────┐
                                  │ 订单支付 │      │ 参加考试 │
                                  └─────────┘      └────┬────┘
                                                        │
                      ┌─────────────────────────────────┘
                      │
                      ▼
                 ┌─────────┐      ┌─────────┐
                 │ 系统批改 │ ───▶ │ 教师评分 │
                 │(客观题)  │      │(主观题)  │
                 └─────────┘      └────┬────┘
                                       │
                                       ▼
                                  ┌─────────┐
                                  │ 成绩计算 │
                                  └────┬────┘
                                       │
              ┌────────────────────────┼────────────────────┐
              │                        │                    │
              ▼                        ▼                    ▼
         ┌─────────┐              ┌─────────┐          ┌─────────┐
         │ 考试通过 │              │ 考试未通过│          │ 补考/重买│
         └────┬────┘              └─────────┘          └─────────┘
              │
              ▼ (所有课程通过)
         ┌─────────┐
         │ 生成证书 │
         └────┬────┘
              │
              ▼
         ┌─────────┐      ┌─────────┐      ┌─────────┐
         │申请纸质证│ ───▶ │ 物流配送 │ ───▶ │ 取证完成 │
         └─────────┘      └─────────┘      └─────────┘
</div>

<div class="page-break"></div>

<!-- ==================== 附录 ==================== -->
<h2>附录：关键业务规则汇总</h2>

<h3>A. 报考相关规则</h3>
<table>
    <tr>
        <th>规则</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>报考有效期</td>
        <td>2年，从审核通过时开始计算</td>
    </tr>
    <tr>
        <td>课程共享</td>
        <td>多个证书包含相同课程时，只需学习一次</td>
    </tr>
    <tr>
        <td>过期处理</td>
        <td>超期未取证，所有成绩作废，需重新报考</td>
    </tr>
</table>

<h3>B. 考试相关规则</h3>
<table>
    <tr>
        <th>规则</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>考试次数</td>
        <td>每门课程2次免费机会（首考+1次补考）</td>
    </tr>
    <tr>
        <td>重新购买</td>
        <td>2次都未通过，需重新购买课程</td>
    </tr>
    <tr>
        <td>主观题提交</td>
        <td>客观题完成后7天内提交，超时0分</td>
    </tr>
</table>

<h3>C. 学习相关规则</h3>
<table>
    <tr>
        <th>规则</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>首次学习</td>
        <td>不可跳过章节，必须按顺序学习</td>
    </tr>
    <tr>
        <td>补学</td>
        <td>考试未通过后重学，可跳过章节</td>
    </tr>
    <tr>
        <td>必修学时</td>
        <td>完成必修学时后才能参加考试</td>
    </tr>
</table>

<h3>D. 订单相关规则</h3>
<table>
    <tr>
        <th>规则</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>普通订单支付时效</td>
        <td>15分钟内完成支付</td>
    </tr>
    <tr>
        <td>报考课程支付时效</td>
        <td>3分钟内完成支付</td>
    </tr>
    <tr>
        <td>超时处理</td>
        <td>超时未支付，订单自动取消</td>
    </tr>
</table>

<hr>

<div style="text-align: center; margin-top: 50px; color: #666;">
    <p><strong>育安教育管理平台</strong></p>
    <p>业务模块逻辑说明文档</p>
    <p>版本：v2.4.0 | 更新日期：2025年12月7日</p>
</div>

</body>
</html>

